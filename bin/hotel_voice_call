#!/usr/bin/env ruby

require_relative '../lib/hotel_voice_agent'

# Simple option parsing
if ARGV.include?('--help') || ARGV.include?('-h')
  puts <<~HELP
    Lanes&Planes Voice Hotel Booking Agent
    
    Usage: #{$0} [options]
    
    Options:
      --guest "Name"           Guest name for the booking
      --booking "REF123"       Booking reference number  
      --hotel "Hotel Name"     Hotel name
      --help, -h               Show this help
    
    Example:
      #{$0} --guest "John Smith" --booking "LP-2024-001" --hotel "Grand Hotel"
    
    This starts a voice-enabled call where the AI acts as a Lanes&Planes employee
    calling the hotel to confirm cost coverage. The AI will speak and listen to
    actual voice responses.
    
    How it works:
    1. AI introduces itself and states purpose
    2. You press Enter to record hotel responses  
    3. AI responds with speech
    4. Call continues until objectives are met
  HELP
  exit 0
end

# Parse command line arguments
guest_name = nil
booking_reference = nil
hotel_name = nil

i = 0
while i < ARGV.length
  case ARGV[i]
  when '--guest'
    guest_name = ARGV[i + 1]
    i += 2
  when '--booking'
    booking_reference = ARGV[i + 1]
    i += 2
  when '--hotel'
    hotel_name = ARGV[i + 1]
    i += 2
  else
    i += 1
  end
end

# Start the voice hotel booking agent
agent = HotelVoiceAgent.new
agent.start_voice_call(
  guest_name: guest_name,
  booking_reference: booking_reference,
  hotel_name: hotel_name
)